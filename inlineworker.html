<html>
<head>
<script>

function createWorker(fn) {
  var blob = new Blob(['self.onmessage = ', fn.toString()], { type: 'text/javascript' });
  var url = URL.createObjectURL(blob); 
  return new Worker(url);
}
let arr = [1,2,3];
let str = "Hi";
  
var myWorker = createWorker(function (e) {
  arr.push(4);
  str+="!";
  e.text = toUpperCase(e.text);
  self.postMessage(e.data.text.toUpperCase(), [arr,str]);
});
console.log("Hi");

myWorker.onmessage = function (e) {
  console.log(e.data); // HELLO FROM AN INLINE WORKER!
}

myWorker.postMessage({text:"Hello",arr:arr,str:str}, [arr,str]);
  
console.log(arr,str);
debugger;
  
</script>
</head>
<body>
</body>
</html>
